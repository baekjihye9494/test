<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.test.sample.mapper.WorkMapper">


	<!-- 로그인한 회원이 근무하는 현장 코드 조회 -->	
	<select id="userSiteName" resultType="String" parameterType="map">
		select 
			s.site_name 
		from 
			member m, usersite u, site s ,authority a
		where 
			m.member_code = u.member_code and
			s.site_code = u.site_code and
	        a.authority_code = m.authority_code and
	        m.member_id = #{param1}
	        u.site_code = #{param2}
		and 
            a.authority_type = 'Y'
	
	</select>
	

	<!-- 조출, 야간 신청리스트 (조회버튼 클릭시) -->
	<select id="selectWorkList" resultType="WorkVO" parameterType="map"> 
		select 
		    w.work_no  workNo,
		    c.confirm_name confirmName,
		    m.member_name memberName,
		    w.work_kind workKind,
		    w.work_location workLocation,
		    w.work_people workPeople,
		    w.work_start_date workStartDate,
		    w.work_end_date workEndDate,
		    
		from
			work w, member m, site s, confirm c
		where 
			m.member_code = w.member_code
		AND w.site_code = s.site_code
		AND w.confirm_code = c.confirm_code

	</select>
	
	
	<!-- 작업게시물 신청 쿼리 -->
	<insert id="addWork">
	insert into work(
				WORK_NO ,
				WORK_PEOPLE ,
				WORK_KIND ,
				MEMBER_CODE ,
				SITE_CODE ,
				CONFIRM_CODE ,
				WORK_START_DATE ,
				WORK_END_DATE ,
				WORK_LOCATION
				)
			values(
				#{auto_no.NEXTVAL},
				#{WORK_PEOPLE},
				#{WORK_KIND},
				#{MEMBER_CODE} ,
				#{SITE_CODE} ,
				#{CONFIRM_CODE},
				#{WORK_START_DATE} ,
				#{WORK_END_DATE} ,
				#{WORK_LOCATION}
			);
			
	</insert>

	
	
	
	
</mapper>